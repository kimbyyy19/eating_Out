---
title: "Eating out"
author: "Kimberly Lemus MUnoz"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`"    
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The data comes from the 1996 General Social Survey answer this question

$H_0$ There is no difference among the various races with frequency of eating out  
$H_A$ There is a statistical difference between at least two races with the frequency of eating out  


```{r include=FALSE,echo=FALSE}
source(file="fisherXY.R")
require(tidyverse)
require(tigerstats)
require(knitr)
require(foreign)
GSS <-read.dta(file="GSS1996.dta")
GSS <- droplevels(GSS)
mydata <- select(GSS,race,age,eatout)
mydata <- na.omit(mydata)
```



### Graphical Results
```{r}
barchartGC(~race + eatout,data=mydata)
barchartGC(~race + eatout,data=mydata, type="percent")

```

Based on the frequency table above, which shows the volume of people who eat out and people who do not eat out for each racial group, we can see that about 950 white people eat out while about 200 do not. Meanwhile, about 200 black people eat out while about 100 do not. For the other racial groups, about 100 people eat out while about 50 do not. Putting this into percentages,80% of white people eat out while 20% do not. Meanwhile black and others have about the same percentages with 70% of the people eat out while 30% do not.    



```{r}
table2 <- xtabs(~race + eatout,data=mydata)
rowPerc(table2)
colPerc(table2)
```
We can see that in the white that said yes was 82.83%, while with the black that said yes was 68.75 .In the different between between percent is about 14%.with the other is 77.78 the different between the other with white is 55% but with the black is 9%.It seem that the black are the least that go out and eat,but with the white is the highest percent between the three.







```{r}
chisq.test(table2)
chisqtestGC(table2)
fisher.test(table2)
```





```{r}
fisherXY = function(x, y, confL = 0, printAll=FALSE){
  # Inputs: 
  #   x: factor variable, 2 levels
  #   y: factor variable, n levels
  # confL: confidence level, default = 0.95
  #        print only those tables, results if p-value < (1-confL)
  # printAll: overide the 'print only if p-value < (1-confL), and
  #           print all tables and fisher test results
  #
  # Constraint:
  #   x and y must be same length
  #
  # Outputs:
  #   All 2x2 Fisher exact tests
  
  if(confL<0 || confL> 1){
    print('error: confL must be between 0 and 1')
    return(999)
  }
  
  if(!is.factor(x)) x=as.factor(x)
  if(!is.factor(y)) y=as.factor(y)
  
  fisherTable = as.matrix(table(x, y))
  cat('\ncontingency table:\n')
  print(fisherTable)
  cat('\n***All 2X2 tests****\n\n')

  # all 2x2 tests
  levelsY = levels(y)
  levelsX = levels(x)
  
  m = length(levelsX)
  n = length(levelsY)
  
  confLevel = 0.95
  if (confL !=0 ) confLevel=confL
  
  for (i in 1:(m-1))
       for(j in ((i+1):m))
          for (k in 1:(n-1))
             for (l in ((k+1):n)) {
                
                 fisherIndexX = c(i,j)
                 fisherIndexY = c(k,l)
                 
                 fTempTable = as.matrix(fisherTable[fisherIndexX,
                                        fisherIndexY])
                 
                 fisherTest=fisher.test(fTempTable, conf.int = TRUE, 
                              conf.level = confLevel)
                 
                 if((fisherTest$p.value < (1-confLevel) ) || printAll){
                   
                       print(c(levelsX[i], levelsX[j]))
                       print(c(levelsY[k], levelsY[l]))
                       print(fTempTable)
                       print(fisherTest)
                       cat('\n')
                 }
                 
        }
}

```
```{r}
fisherXY(mydata$race,mydata$eatout,printAll = TRUE)
```

We can see in the Fisher test that the p-value is seem to very low and not very something that will happen.










